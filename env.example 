# AI-Powered Video Commerce Recommender - Environment Configuration
# =====================================================================
# Copy this file to .env and modify the values according to your setup
# 
# Usage: cp .env.example .env

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Environment (development, production, testing)
ENVIRONMENT=development

# Application Info
APP_NAME="AI Video Commerce Recommender"
APP_VERSION="1.0.0"
APP_DESCRIPTION="Production-ready AI system for video-based product recommendations"

# =============================================================================
# API SERVER CONFIGURATION
# =============================================================================

# Server Settings
API_HOST=0.0.0.0
API_PORT=8000
API_DEBUG=true
API_RELOAD=true
API_WORKERS=1

# Request Limits
API_MAX_REQUEST_SIZE=104857600  # 100MB
API_REQUEST_TIMEOUT=30
API_MAX_CONCURRENT_REQUESTS=100

# CORS Settings
API_CORS_ORIGINS=["*"]
API_CORS_CREDENTIALS=true

# Security
API_SECRET_KEY=your-secret-key-change-this-in-production
API_ACCESS_TOKEN_EXPIRE_MINUTES=30
API_RATE_LIMIT_REQUESTS=1000  # per minute

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Connection
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_DECODE_RESPONSES=true

# Redis Advanced Settings
REDIS_MAX_CONNECTIONS=100
REDIS_SOCKET_TIMEOUT=30
REDIS_SOCKET_CONNECT_TIMEOUT=30
REDIS_RETRY_ON_TIMEOUT=true
REDIS_HEALTH_CHECK_INTERVAL=30

# Redis Cluster (if using Redis Cluster)
# REDIS_CLUSTER_NODES=localhost:7000,localhost:7001,localhost:7002
# REDIS_CLUSTER_SKIP_FULL_COVERAGE_CHECK=false

# =============================================================================
# MODEL CONFIGURATION
# =============================================================================

# CLIP Model Settings
MODEL_CLIP_MODEL=openai/clip-vit-large-patch14
MODEL_EMBEDDING_DIM=512

# Model Paths
MODEL_RANKING_MODEL_PATH=./models/ranking_model.pth
MODEL_CF_MODEL_PATH=./models/cf_model.pkl
MODEL_CACHE_DIR=./tmp/models

# Processing Settings
MODEL_DEVICE=auto  # auto, cpu, cuda
MODEL_BATCH_SIZE=32
MODEL_CACHE_DIR=./tmp/models
MODEL_MAX_VIDEO_LENGTH=300  # seconds
MODEL_NUM_KEYFRAMES=8

# Performance Settings
MODEL_ENABLE_QUANTIZATION=false
MODEL_ENABLE_GPU=true
MODEL_MAX_CONCURRENT_REQUESTS=10

# =============================================================================
# VECTOR SEARCH CONFIGURATION
# =============================================================================

# FAISS Index Settings
VECTOR_INDEX_PATH=./tmp/vector_index.faiss
VECTOR_EMBEDDING_DIM=512
VECTOR_INDEX_TYPE=HNSW

# HNSW Parameters
VECTOR_HNSW_M=32
VECTOR_HNSW_EF_CONSTRUCTION=200
VECTOR_HNSW_EF_SEARCH=50

# Search Parameters
VECTOR_SEARCH_K=100
VECTOR_SIMILARITY_THRESHOLD=0.1

# =============================================================================
# RECOMMENDATION ENGINE CONFIGURATION
# =============================================================================

# Collaborative Filtering
RECOMMENDATION_CF_FACTORS=64
RECOMMENDATION_CF_REGULARIZATION=0.1
RECOMMENDATION_CF_ITERATIONS=50

# Candidate Generation
RECOMMENDATION_CANDIDATES_PER_SOURCE=100
RECOMMENDATION_MAX_TOTAL_CANDIDATES=500

# Ranking Weights
RECOMMENDATION_CF_WEIGHT=0.4
RECOMMENDATION_CONTENT_WEIGHT=0.3
RECOMMENDATION_POPULARITY_WEIGHT=0.3

# Trending Algorithm
RECOMMENDATION_TRENDING_DECAY_FACTOR=0.95
RECOMMENDATION_TRENDING_WINDOW_HOURS=24

# Diversity Settings
RECOMMENDATION_ENABLE_DIVERSITY=true
RECOMMENDATION_DIVERSITY_FACTOR=0.1
RECOMMENDATION_MAX_ITEMS_PER_CATEGORY=3

# =============================================================================
# RANKING MODEL CONFIGURATION
# =============================================================================

# Model Architecture
RANKING_MODEL_TYPE=neural
RANKING_HIDDEN_DIMS=[256,128,64]
RANKING_DROPOUT_RATE=0.2
RANKING_LEARNING_RATE=0.001

# Multi-Objective Settings
RANKING_ENABLE_MULTI_OBJECTIVE=true
RANKING_CTR_WEIGHT=1.0
RANKING_CVR_WEIGHT=2.0
RANKING_GMV_WEIGHT=3.0

# Training Settings
RANKING_EPOCHS=100
RANKING_BATCH_SIZE=1024
RANKING_EARLY_STOPPING_PATIENCE=10

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Cache Settings
CACHE_ENABLE_CACHING=true
CACHE_DEFAULT_TTL=3600  # 1 hour
CACHE_USER_FEATURES_TTL=1800  # 30 minutes
CACHE_CONTENT_FEATURES_TTL=86400  # 24 hours
CACHE_RECOMMENDATIONS_TTL=900  # 15 minutes

# Cache Limits
CACHE_MAX_CACHE_SIZE=10000
CACHE_CLEANUP_INTERVAL=3600

# Adaptive Caching
CACHE_ADAPTIVE_TTL=true
CACHE_HIGH_ACTIVITY_TTL=300  # 5 minutes
CACHE_LOW_ACTIVITY_TTL=7200  # 2 hours

# =============================================================================
# DATA CONFIGURATION
# =============================================================================

# Sample Data
DATA_LOAD_SAMPLE_DATA=true
DATA_SAMPLE_DATA_PATH=./data/sample_products.json
DATA_UPLOAD_DIR=./tmp/uploads
DATA_SAMPLE_USERS=1000
DATA_SAMPLE_INTERACTIONS=10000

# File Upload
DATA_UPLOAD_DIR=./tmp/uploads
DATA_MAX_FILE_SIZE=524288000  # 500MB
DATA_ALLOWED_EXTENSIONS=[".mp4",".avi",".mov",".mkv"]

# Data Processing
DATA_CLEANUP_TEMP_FILES=true
DATA_TEMP_FILE_TTL=3600

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Logging
MONITORING_LOG_LEVEL=INFO
MONITORING_LOG_FORMAT="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
MONITORING_ENABLE_REQUEST_LOGGING=true

# Metrics
MONITORING_ENABLE_METRICS=true
MONITORING_METRICS_INTERVAL=60
MONITORING_SLOW_REQUEST_THRESHOLD=1.0

# Health Checks
MONITORING_HEALTH_CHECK_INTERVAL=30
MONITORING_COMPONENT_TIMEOUT=5

# Alerting Thresholds
MONITORING_ERROR_RATE_THRESHOLD=0.05
MONITORING_RESPONSE_TIME_THRESHOLD=500  # ms
MONITORING_MEMORY_THRESHOLD=0.8

# External Monitoring (Optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# DATADOG_API_KEY=your-datadog-api-key
# NEW_RELIC_LICENSE_KEY=your-new-relic-license-key

# =============================================================================
# EXTERNAL SERVICES (OPTIONAL)
# =============================================================================

# AWS Configuration
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# AWS_DEFAULT_REGION=us-west-2
# AWS_S3_BUCKET=your-s3-bucket

# Google Cloud Configuration
# GOOGLE_APPLICATION_CREDENTIALS=./path/to/service-account.json
# GOOGLE_CLOUD_PROJECT=your-project-id
# GOOGLE_CLOUD_REGION=us-central1

# Azure Configuration
# AZURE_STORAGE_CONNECTION_STRING=your-azure-connection-string
# AZURE_STORAGE_CONTAINER=your-container-name

# =============================================================================
# DATABASE CONFIGURATION (OPTIONAL)
# =============================================================================

# PostgreSQL (if using instead of Redis for some data)
# DATABASE_URL=postgresql://username:password@localhost:5432/dbname
# DATABASE_POOL_SIZE=20
# DATABASE_MAX_OVERFLOW=30
# DATABASE_ECHO=false

# MongoDB (for document storage)
# MONGODB_URL=mongodb://localhost:27017
# MONGODB_DATABASE=video_commerce
# MONGODB_COLLECTION=products

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development Tools
DEV_ENABLE_PROFILING=false
DEV_ENABLE_DEBUG_TOOLBAR=false
DEV_RELOAD_TEMPLATES=true

# Testing
TEST_DATABASE_URL=sqlite:///./test.db
TEST_REDIS_HOST=localhost
TEST_REDIS_PORT=6380

# =============================================================================
# PRODUCTION SETTINGS
# =============================================================================

# Production Overrides (when ENVIRONMENT=production)
# These will override the above settings in production

# Security
PROD_API_DEBUG=false
PROD_API_RELOAD=false
PROD_MONITORING_LOG_LEVEL=WARNING

# Performance
PROD_API_WORKERS=4
PROD_MODEL_ENABLE_QUANTIZATION=true
PROD_CACHE_DEFAULT_TTL=7200

# Monitoring
PROD_MONITORING_ENABLE_METRICS=true
PROD_SENTRY_SAMPLE_RATE=0.1

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

# Docker Compose Services
COMPOSE_PROJECT_NAME=video-commerce-recommender
COMPOSE_FILE=docker-compose.yml

# Container Settings
CONTAINER_MEMORY_LIMIT=4g
CONTAINER_CPU_LIMIT=2.0

# =============================================================================
# KUBERNETES CONFIGURATION (OPTIONAL)
# =============================================================================

# Kubernetes Namespace
K8S_NAMESPACE=video-commerce
K8S_SERVICE_ACCOUNT=video-commerce-sa

# Resource Limits
K8S_MEMORY_REQUEST=2Gi
K8S_MEMORY_LIMIT=4Gi
K8S_CPU_REQUEST=1.0
K8S_CPU_LIMIT=2.0

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Experimental Features
FEATURE_ENABLE_A_B_TESTING=false
FEATURE_ENABLE_REAL_TIME_TRAINING=false
FEATURE_ENABLE_GRAPH_RECOMMENDATIONS=false
FEATURE_ENABLE_AUDIO_PROCESSING=false

# Model Features
FEATURE_ENABLE_CLIP_LARGE=true
FEATURE_ENABLE_MULTILINGUAL=false
FEATURE_ENABLE_CUSTOM_EMBEDDINGS=false

# =============================================================================
# NOTES AND DOCUMENTATION
# =============================================================================

# Environment Setup Notes:
# ========================
#
# 1. Copy this file: cp .env.example .env
# 2. Modify values according to your setup
# 3. Never commit .env to version control
# 4. Use different .env files for different environments
#
# Required External Services:
# ===========================
# - Redis server (for caching and feature store)
# - FFmpeg (for video processing)
# - Tesseract OCR (for text extraction)
#
# Optional Services:
# ==================
# - PostgreSQL (for relational data)
# - MongoDB (for document storage)
# - Elasticsearch (for search)
# - Prometheus/Grafana (for monitoring)
#
# Security Considerations:
# ========================
# - Change all default passwords and keys
# - Use strong, unique passwords
# - Enable SSL/TLS in production
# - Restrict network access with firewalls
# - Regular security updates
#
# Performance Tips:
# =================
# - Use SSD storage for model cache
# - Enable GPU acceleration if available
# - Tune cache TTL values based on usage
# - Monitor memory usage and adjust limits
# - Use connection pooling for databases
#
# Troubleshooting:
# ================
# - Check logs in ./logs/ directory
# - Verify service connectivity with health checks
# - Monitor resource usage with system metrics
# - Test configuration with ./startup.sh setup